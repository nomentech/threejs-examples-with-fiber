"use strict";(self.webpackChunkthreejs_examples_with_fiber=self.webpackChunkthreejs_examples_with_fiber||[]).push([[767],{6710:function(e,t,r){r.d(t,{Pf:function(){return a},Uv:function(){return n},fx:function(){return i}});var i=window.innerWidth>640?window.innerWidth-300:window.innerWidth,n=window.innerWidth>640?window.innerHeight:window.innerHeight-48,a=i/n},1462:function(e,t,r){r.r(t),r.d(t,{default:function(){return L}});var i=r(2791),n=r(323),a=r(3144),o=r(5671),c=(0,a.Z)((function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:512,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512;(0,o.Z)(this,e),this.colorMatrixLeft=(new n.Matrix3).fromArray([.4561,-.0400822,-.0152161,.500484,-.0378246,-.0205971,.176381,-.0157589,-.00546856]),this.colorMatrixRight=(new n.Matrix3).fromArray([-.0434706,.378476,-.0721527,-.0879388,.73364,-.112961,-.00155529,-.0184503,1.2264]);var a=new n.OrthographicCamera(-1,1,1,-1,0,1),c=new n.Scene,s=new n.StereoCamera,l={minFilter:n.LinearFilter,magFilter:n.NearestFilter,format:n.RGBAFormat},d=new n.WebGLRenderTarget(r,i,l),u=new n.WebGLRenderTarget(r,i,l),v=new n.ShaderMaterial({uniforms:{mapLeft:{value:d.texture},mapRight:{value:u.texture},colorMatrixLeft:{value:this.colorMatrixLeft},colorMatrixRight:{value:this.colorMatrixRight}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","uniform mat3 colorMatrixLeft;","uniform mat3 colorMatrixRight;","float lin( float c ) {","\treturn c <= 0.04045 ? c * 0.0773993808 :","\t\t\tpow( c * 0.9478672986 + 0.0521327014, 2.4 );","}","vec4 lin( vec4 c ) {","\treturn vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );","}","float dev( float c ) {","\treturn c <= 0.0031308 ? c * 12.92","\t\t\t: pow( c, 0.41666 ) * 1.055 - 0.055;","}","void main() {","\tvec2 uv = vUv;","\tvec4 colorL = lin( texture2D( mapLeft, uv ) );","\tvec4 colorR = lin( texture2D( mapRight, uv ) );","\tvec3 color = clamp(","\t\t\tcolorMatrixLeft * colorL.rgb +","\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );","\tgl_FragColor = vec4(","\t\t\tdev( color.r ), dev( color.g ), dev( color.b ),","\t\t\tmax( colorL.a, colorR.a ) );","}"].join("\n")}),f=new n.Mesh(new n.PlaneGeometry(2,2),v);c.add(f),this.setSize=function(e,r){t.setSize(e,r);var i=t.getPixelRatio();d.setSize(e*i,r*i),u.setSize(e*i,r*i)},this.render=function(e,r){var i=t.getRenderTarget();e.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),s.update(r),t.setRenderTarget(d),t.clear(),t.render(e,s.cameraL),t.setRenderTarget(u),t.clear(),t.render(e,s.cameraR),t.setRenderTarget(null),t.render(c,a),t.setRenderTarget(i)},this.dispose=function(){d.dispose(),u.dispose(),f.geometry.dispose(),f.material.dispose()}})),s=r(4647),l=r(7219),d=r(6710),u=r.p+"static/media/px.2790714e584d469b4c8f.png",v=r.p+"static/media/py.4feb318e7c3697b3c18e.png",f=r.p+"static/media/pz.655cf3041ec3918dabd2.png",m=r.p+"static/media/nx.f11c406a9d6ff8306921.png",p=r.p+"static/media/ny.2ebc515c0945d2bcffa3.png",h=r.p+"static/media/nz.1791e49fdd6d695c9dc2.png",g=r(184),x=0,w=0,M=[u,m,v,p,f,h],R=(new n.CubeTextureLoader).load(M);document.addEventListener("mousemove",(function(e){x=(e.clientX-d.fx/2)/100,w=(e.clientY-d.Uv/2)/100}));var b=function(){var e=(0,l.w)(),t=e.gl,r=e.scene,n=e.camera,a=new c(t);a.setSize(d.fx||2,d.Uv||2);for(var o=(0,i.useMemo)((function(){for(var e=[],t=0;t<500;t++)e.push((0,i.createRef)());return e}),[]),s=[],u=0;u<500;u++)s.push((0,g.jsxs)("mesh",{scale:3*Math.random()+1,ref:o[u],position:[10*Math.random()-5,10*Math.random()-5,10*Math.random()-5],children:[(0,g.jsx)("sphereGeometry",{args:[.1,32,16]}),(0,g.jsx)("meshBasicMaterial",{color:16777215,envMap:R})]},u));return(0,l.x)((function(){var e=1e-4*Date.now();n.position.x+=.05*(x-n.position.x),n.position.y+=.05*(-w-n.position.y),n.lookAt(r.position);for(var t=0,i=o.length;t<i;t++){var c=o[t].current;c.position.x=5*Math.cos(e+t),c.position.y=5*Math.sin(e+1.1*t)}a.render(r,n)})),(0,g.jsx)(g.Fragment,{children:s.map((function(e){return e}))})},L=function(){var e=new n.PerspectiveCamera(60,d.Pf,.01,100);return e.position.z=3,e.setFocalLength(3),(0,g.jsxs)(s.Xz,{children:[(0,g.jsx)("primitive",{attach:"camera",object:e,makeDefault:!0}),(0,g.jsx)("primitive",{attach:"background",object:R}),(0,g.jsx)(b,{})]})}}}]);
//# sourceMappingURL=767.cbc355ff.chunk.js.map