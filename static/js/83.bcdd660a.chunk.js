"use strict";(self.webpackChunkthreejs_examples_with_fiber=self.webpackChunkthreejs_examples_with_fiber||[]).push([[83],{6083:function(e,t,n){n.r(t);var i,a,o,r=n(3433),s=n(2791),c=n(323),l=n(7219),d=n(4647),h=n(3655),f=n(3520),u=n(7786),m=n(184);h.L.preload("/models/Xbot.glb");var p,v,g=[],w="idle",j=[],b={idle:{weight:1},walk:{weight:0},run:{weight:0}},x={sneak_pose:{weight:0},sad_pose:{weight:0},agree:{weight:0},headShake:{weight:0}},k=function(e,t){e.enabled=!0,e.setEffectiveTimeScale(1),e.setEffectiveWeight(t)},A=function(e){var t=e.getClip(),n=b[t.name]||x[t.name];k(e,n.weight),e.play()},E=function(e){o.timeScale=e},C=function(e,t,n){o.addEventListener("loop",(function i(a){a.action===e&&(o.removeEventListener("loop",i),S(e,t,n))}))},S=function(e,t,n){t?(k(t,1),t.time=0,e?e.crossFadeTo(t,n,!0):t.fadeIn(n)):e.fadeOut(n)},_=function(){var e=(0,h.L)("/models/Xbot.glb"),t=e.scene,n=e.animations;i=t,o=new c.AnimationMixer(i),v=n.length;for(var r=0;r!==v;++r){var d=n[r],f=d.name;if(b[f]){var u=o.clipAction(d);A(u),b[f].action=u,j.push(u)}else if(x[f]){c.AnimationUtils.makeClipAdditive(d),d.name.endsWith("_pose")&&(d=c.AnimationUtils.subclip(d,d.name,2,3,30));var p=o.clipAction(d);A(p),x[f].action=p,j.push(p)}}return(a=new c.SkeletonHelper(t)).visible=!1,(0,l.x)((function(e,t){for(var n=0;n!==v;++n){var i=j[n],a=i.getClip();(b[a.name]||x[a.name]).weight=i.getEffectiveWeight()}var r=t;o.update(r)})),(0,s.useEffect)((function(){t.traverse((function(e){return e.isMesh&&(e.castShadow=!0)}))}),[t]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("primitive",{object:t}),(0,m.jsx)("primitive",{object:a}),(0,m.jsx)(y,{})]})},y=function(){var e=new u.XS({width:310});return(0,s.useEffect)((function(){var t=e.addFolder("Base Actions"),n=e.addFolder("Additive Action Weights"),i=e.addFolder("General Speed");p={"modify time scale":1};for(var a=["None"].concat((0,r.Z)(Object.keys(b))),o=function(e,n){var i=a[e],o=b[i];p[i]=function(){var e=b[w];!function(e,t,n){if("idle"!==w&&e&&t?C(e,t,n):S(e,t,n),t){var i=t.getClip();w=i.name}else w="None";g.forEach((function(e){e.property===w?e.setActive():e.setInactive()}))}(e?e.action:null,o?o.action:null,.35)},g.push(t.add(p,i))},s=0,c=a.length;s!==c;++s)o(s);for(var l=function(){var e=h[d],t=x[e];p[e]=t.weight,n.add(p,e,0,1,.01).listen().onChange((function(e){k(t.action,e),t.weight=e}))},d=0,h=Object.keys(x);d<h.length;d++)l();i.add(p,"modify time scale",0,1.5,.01).onChange(E),t.open(),n.open(),i.open(),g.forEach((function(e){e.setInactive=function(){e.domElement.classList.add("control-inactive")},e.setActive=function(){e.domElement.classList.remove("control-inactive")};var t=b[e.property];t&&t.weight||e.setInactive()}))})),null},L=function(){return(0,m.jsxs)("mesh",{rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[(0,m.jsx)("planeGeometry",{args:[100,100]}),(0,m.jsx)("meshPhongMaterial",{color:10066329,depthWrite:!1})]})};t.default=function(){return(0,m.jsxs)(d.Xz,{camera:{position:[-1,2,3],fov:45,near:1,far:100},dpr:[1,2],shadows:!0,children:[(0,m.jsx)("color",{attach:"background",args:[10526880]}),(0,m.jsx)("fog",{attach:"fog",color:10526880,near:10,far:50}),(0,m.jsx)("hemisphereLight",{color:16777215,groundColor:4473924,position:[0,20,0]}),(0,m.jsx)("directionalLight",{color:16777215,position:[3,10,10],castShadow:!0,"shadow-camera-left":-2,"shadow-camera-right":2,"shadow-camera-top":2,"shadow-camera-bottom":-2,"shadow-camera-near":.1,"shadow-camera-far":40}),(0,m.jsx)(L,{}),(0,m.jsx)(_,{}),(0,m.jsx)(f.z,{enablePan:!1,enableZoom:!1,target:[0,1,0]})]})}}}]);
//# sourceMappingURL=83.bcdd660a.chunk.js.map