"use strict";(self.webpackChunkthreejs_examples_with_fiber=self.webpackChunkthreejs_examples_with_fiber||[]).push([[735],{6710:function(e,n,a){a.d(n,{P:function(){return r}});var r=(window.innerWidth>640?window.innerWidth-300:window.innerWidth)/(window.innerWidth>640?window.innerHeight:window.innerHeight-48)},7735:function(e,n,a){a.r(n);var r,t,i,o,s,l=a(2791),c=a(323),h=a(7786),d=a(7219),u=a(4647),p=a(3520),w=a(6710),f=a(184),g=function(){var e=new c.Vector3,n=new c.Vector3,a=new c.Vector3;return function(r){var t=r.normal,i=new c.Matrix4;return Math.abs(t.x)>Math.abs(t.z)?n.set(-t.y,t.x,0):n.set(0,-t.z,t.y),e.crossVectors(n.normalize(),t),r.coplanarPoint(a),i.set(e.x,n.x,t.x,a.x,e.y,n.y,t.y,a.y,e.z,n.z,t.z,a.z,0,0,0,1)}}(),m=function(e){for(var n=new Array(e),a=0;a!==e;++a)n[a]=new c.Plane;return n},x=function(e,n,a){for(var r=0,t=n.length;r!==t;++r)e[r].copy(n[r]).applyMatrix4(a)},b=function(e,n){var a=e.parent;e.matrix.copy(a.matrixWorld).invert(),e.applyMatrix4(n)},v=function(e,n){for(var a=n.length/3,r=new Array(a),t=0,i=0;t<a;++t,i+=3){var o=e[n[i]],s=e[n[i+1]],l=e[n[i+2]];r[t]=(new c.Plane).setFromCoplanarPoints(o,s,l)}return r}([new c.Vector3(1,0,Math.SQRT1_2),new c.Vector3(-1,0,Math.SQRT1_2),new c.Vector3(0,1,-Math.SQRT1_2),new c.Vector3(0,-1,-Math.SQRT1_2)],[0,1,2,0,2,3,0,3,1,1,3,2]),j=v.map(g),M=function(e,n){for(var a=m(e),r=0;r!==e;++r){var t=a[r],i=r*Math.PI*2/e;t.normal.set(Math.cos(i),0,Math.sin(i)),t.constant=n}return a}(5,2.5),y=Object.freeze([]),S=new c.Matrix4,P=new c.Matrix4,z=function(){return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("ambientLight",{args:[16777215,.3]}),(0,f.jsx)("spotLight",{color:16777215,intensity:.5,angle:Math.PI/5,penumbra:.2,position:[2,3,3],castShadow:!0,"shadow-camera-near":3,"shadow-camera-far":10,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024}),(0,f.jsx)("directionalLight",{color:16777215,intensity:.5,position:[0,2,0],castShadow:!0,"shadow-camera-near":1,"shadow-camera-far":10,"shadow-camera-right":1,"shadow-camera-left":-1,"shadow-camera-top":1,"shadow-camera-bottom":-1,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024})]})},E=function(){var e=(0,d.w)().gl;r=e,i=m(M.length),e.clippingPlanes=y,e.localClippingEnabled=!0,t=new c.MeshPhongMaterial({color:15600144,shininess:100,side:c.DoubleSide,clippingPlanes:m(v.length),clipShadows:!0});var n=(0,l.useRef)();(0,d.x)((function(){var e=(Date.now()-o)/1e3;n.current.position.y=1,n.current.rotation.x=.5*e,n.current.rotation.y=.2*e,n.current.updateMatrix(),S.copy(n.current.matrix);var a=.5*Math.cos(.5*e)+.7;S.multiply(P.makeScale(a,a,a)),x(t.clippingPlanes,v,S);for(var r=s.current.children,l=0,c=r.length;l!==c;++l)P.multiplyMatrices(S,j[l]),b(r[l],P);S.makeRotationY(.1*e),x(i,M,S)}));for(var a=[],h=-2;h<=2;++h)for(var u=-2;u<=2;++u)for(var p=-2;p<=2;++p)a.push((0,f.jsx)("mesh",{material:t,position:[p/5,u/5,h/5],castShadow:!0,children:(0,f.jsx)("boxGeometry",{args:[.18,.18,.18]})},Math.random()));return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("group",{ref:n,children:a}),(0,f.jsx)(V,{})]})},V=function(){for(var e=[],n=new c.Color,a=function(a,r){e.push((0,f.jsxs)("mesh",{matrixAutoUpdate:!1,children:[(0,f.jsx)("planeGeometry",{args:[3,3,1,1]}),(0,f.jsx)("meshBasicMaterial",{color:n.setHSL(a/r,.5,.5).getHex(),side:c.DoubleSide,opacity:.2,transparent:!0,clippingPlanes:t.clippingPlanes.filter((function(e,n){return n!==a}))})]},Math.random()))},o=0,d=v.length;o!==d;++o)a(o,d);return s=(0,l.useRef)(),(0,l.useEffect)((function(){s.current.visible=!1,function(){var e=new h.XS,n=e.addFolder("Local Clipping"),a={get Enabled(){return r.localClippingEnabled},set Enabled(e){r.localClippingEnabled=e,e||(s.current.visible=!1)},get Shadows(){return t.clipShadows},set Shadows(e){t.clipShadows=e},get Visualize(){return s.current.visible},set Visualize(e){r.localClippingEnabled&&(s.current.visible=e)}};n.add(a,"Enabled"),n.add(a,"Shadows"),n.add(a,"Visualize").listen(),e.addFolder("Global Clipping").add({get Enabled(){return r.clippingPlanes!==y},set Enabled(e){r.clippingPlanes=e?i:y}},"Enabled")}()}),[]),(0,f.jsx)(f.Fragment,{children:(0,f.jsx)("group",{ref:s,children:e})})},C=function(){return(0,f.jsxs)("mesh",{rotation:[-Math.PI/2,0,0],scale:3,receiveShadow:!0,children:[(0,f.jsx)("planeGeometry",{args:[3,3,1,1]}),(0,f.jsx)("meshPhongMaterial",{color:10530223,shininess:10})]})};n.default=function(){return(0,l.useEffect)((function(){o=Date.now()}),[]),(0,f.jsxs)(u.Xz,{camera:{position:[0,1.5,3],fov:36,aspect:w.P,near:.25,far:16},shadows:!0,children:[(0,f.jsx)("color",{attach:"background",args:["black"]}),(0,f.jsx)(z,{}),(0,f.jsx)(E,{}),(0,f.jsx)(C,{}),(0,f.jsx)(p.z,{target:[0,1,0],minDistance:1,maxDistance:8})]})}}}]);
//# sourceMappingURL=735.81420948.chunk.js.map