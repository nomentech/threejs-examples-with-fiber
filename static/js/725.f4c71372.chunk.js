"use strict";(self.webpackChunkthreejs_examples_with_fiber=self.webpackChunkthreejs_examples_with_fiber||[]).push([[725],{6710:function(e,t,r){r.d(t,{Pf:function(){return a},Uv:function(){return n},fx:function(){return i}});var i=window.innerWidth>640?window.innerWidth-300:window.innerWidth,n=window.innerWidth>640?window.innerHeight:window.innerHeight-48,a=i/n},9358:function(e,t,r){r.r(t),r.d(t,{default:function(){return b}});var i=r(2791),n=r(7760),a=function(e,t,r){this.colorMatrixLeft=(new n.Matrix3).fromArray([.4561,-.0400822,-.0152161,.500484,-.0378246,-.0205971,.176381,-.0157589,-.00546856]),this.colorMatrixRight=(new n.Matrix3).fromArray([-.0434706,.378476,-.0721527,-.0879388,.73364,-.112961,-.00155529,-.0184503,1.2264]);var i=new n.OrthographicCamera(-1,1,1,-1,0,1),a=new n.Scene,o=new n.StereoCamera,c={minFilter:n.LinearFilter,magFilter:n.NearestFilter,format:n.RGBAFormat};void 0===t&&(t=512),void 0===r&&(r=512);var s=new n.WebGLRenderTarget(t,r,c),l=new n.WebGLRenderTarget(t,r,c),d=new n.ShaderMaterial({uniforms:{mapLeft:{value:s.texture},mapRight:{value:l.texture},colorMatrixLeft:{value:this.colorMatrixLeft},colorMatrixRight:{value:this.colorMatrixRight}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","uniform mat3 colorMatrixLeft;","uniform mat3 colorMatrixRight;","float lin( float c ) {","\treturn c <= 0.04045 ? c * 0.0773993808 :","\t\t\tpow( c * 0.9478672986 + 0.0521327014, 2.4 );","}","vec4 lin( vec4 c ) {","\treturn vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );","}","float dev( float c ) {","\treturn c <= 0.0031308 ? c * 12.92","\t\t\t: pow( c, 0.41666 ) * 1.055 - 0.055;","}","void main() {","\tvec2 uv = vUv;","\tvec4 colorL = lin( texture2D( mapLeft, uv ) );","\tvec4 colorR = lin( texture2D( mapRight, uv ) );","\tvec3 color = clamp(","\t\t\tcolorMatrixLeft * colorL.rgb +","\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );","\tgl_FragColor = vec4(","\t\t\tdev( color.r ), dev( color.g ), dev( color.b ),","\t\t\tmax( colorL.a, colorR.a ) );","}"].join("\n")}),u=new n.Mesh(new n.PlaneGeometry(2,2),d);a.add(u),this.setSize=function(t,r){e.setSize(t,r);var i=e.getPixelRatio();s.setSize(t*i,r*i),l.setSize(t*i,r*i)},this.render=function(t,r){var n=e.getRenderTarget();t.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld(),o.update(r),e.setRenderTarget(s),e.clear(),e.render(t,o.cameraL),e.setRenderTarget(l),e.clear(),e.render(t,o.cameraR),e.setRenderTarget(null),e.render(a,i),e.setRenderTarget(n)},this.dispose=function(){s&&s.dispose(),l&&l.dispose(),u&&u.geometry.dispose(),d&&d.dispose()}},o=r(4150),c=r(2794),s=r(6710),l=r.p+"static/media/px.2790714e584d469b4c8f.png",d=r.p+"static/media/py.4feb318e7c3697b3c18e.png",u=r.p+"static/media/pz.655cf3041ec3918dabd2.png",f=r.p+"static/media/nx.f11c406a9d6ff8306921.png",m=r.p+"static/media/ny.2ebc515c0945d2bcffa3.png",v=r.p+"static/media/nz.1791e49fdd6d695c9dc2.png",p=r(184),h=0,g=0,x=[l,f,d,m,u,v],w=(new n.CubeTextureLoader).load(x);document.addEventListener("mousemove",(function(e){h=(e.clientX-s.fx/2)/100,g=(e.clientY-s.Uv/2)/100}));var M=function(){var e=(0,c.w)(),t=e.gl,r=e.scene,n=e.size,o=e.camera,s=(0,i.useMemo)((function(){return new a(t)}),[]);return(0,i.useEffect)((function(){s.setSize(n.width||2,n.height||2)}),[n]),(0,c.x)((function(){s.render(r,o)}),1),null},R=function(){for(var e=(0,c.w)(),t=e.scene,r=e.camera,n=(0,i.useMemo)((function(){for(var e=[],t=0;t<500;t++)e.push((0,i.createRef)());return e}),[]),a=[],o=0;o<500;o++)a.push((0,p.jsxs)("mesh",{scale:3*Math.random()+1,ref:n[o],position:[10*Math.random()-5,10*Math.random()-5,10*Math.random()-5],children:[(0,p.jsx)("sphereGeometry",{args:[.1,32,16]}),(0,p.jsx)("meshBasicMaterial",{color:16777215,envMap:w})]},o));return(0,c.x)((function(e){var i=.1*e.clock.getElapsedTime();r.position.x+=.05*(h-r.position.x),r.position.y+=.05*(-g-r.position.y),r.lookAt(t.position);for(var a=0,o=n.length;a<o;a++){var c=n[a].current;c.position.x=5*Math.cos(i+a),c.position.y=5*Math.sin(i+1.1*a)}})),(0,p.jsx)(p.Fragment,{children:a.map((function(e){return e}))})},b=function(){var e=new n.PerspectiveCamera(60,s.Pf,.01,100);return e.position.z=3,e.setFocalLength(3),(0,p.jsxs)(o.Xz,{children:[(0,p.jsx)("primitive",{attach:"camera",object:e,makeDefault:!0}),(0,p.jsx)("primitive",{attach:"background",object:w}),(0,p.jsx)(R,{}),(0,p.jsx)(M,{})]})}}}]);
//# sourceMappingURL=725.f4c71372.chunk.js.map